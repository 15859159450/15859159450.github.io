<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cluster 8 关键词热力图 (2000-2024)</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            padding: 25px;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        h1 {
            color: #2c3e50;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        .description {
            color: #7f8c8d;
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.1rem;
        }
        .chart-container {
            width: 100%;
            height: 700px;
            margin: 20px 0;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .legend {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border-radius: 3px;
        }
        footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 500px;
            }
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Cluster 8 关键词热力图 (2000-2024)</h1>
            <p class="description">展示Cluster 8中2000-2024年视觉艺术与设计相关关键词的数据变化情况。颜色越深表示数值越大，每个单元格内显示具体数值。</p>
        </header>
        
        <div class="controls">
            <button class="btn" id="toggle-labels">切换数值显示</button>
            <button class="btn" id="change-color">切换配色方案</button>
            <button class="btn" id="reset-view">重置视图</button>
        </div>
        
        <div id="chart-container" class="chart-container"></div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #fee5d9;"></div>
                <span>低值 (0-500)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #fcae91;"></div>
                <span>中低值 (500-1000)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #fb6a4a;"></div>
                <span>中值 (1000-1500)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #de2d26;"></div>
                <span>中高值 (1500-2000)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #a50f15;"></div>
                <span>高值 (2000+)</span>
            </div>
        </div>
        
        <footer>
            <p>数据来源: 1128英文-关键词-热点.xlsx - Cluster 8 | 使用ECharts生成</p>
        </footer>
    </div>

    <script>
        // 按照表格中的原始顺序提取Cluster 8的数据 (2000-2024)
        // 注意：这里保持表格中的原始顺序，但我们会通过yAxis.inverse来反转显示
        const categories = [
            'Visual', 'Animation', 'Graphic', 'Designer', 'Color',
            'Information', 'Technology', 'Human', 'Environment', 'Form',
            'Symbol', 'Artist', 'Furniture', 'Image', 'Modeling',
            'Style', 'Logo', 'World', 'Creation', 'Painting'
        ];
        
        const years = [
            '2000', '2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009',
            '2010', '2011', '2012', '2013', '2014', '2015', '2016', '2017', '2018', '2019',
            '2020', '2021', '2022', '2023', '2024'
        ];
        
        // 数据矩阵 - 行: 类别, 列: 年份 (2000-2024)，完全按照Excel表格中的顺序
        const dataMatrix = [
            [112, 431, 754, 1125, 1291, 1969, 2591, 1424, 1312, 1327, 1348, 1437, 1549, 945, 1470, 1729, 1458, 1572, 1346, 1368, 1352, 1416, 1175, 1305, 1436],
            [1, 10, 84, 50, 189, 68, 305, 634, 605, 883, 343, 1042, 777, 621, 454, 482, 505, 363, 698, 1168, 850, 593, 541, 367, 288],
            [109, 129, 349, 714, 505, 1135, 1121, 651, 689, 510, 787, 721, 786, 518, 809, 736, 823, 576, 399, 336, 659, 205, 214, 229, 243],
            [180, 279, 906, 1176, 837, 1335, 1392, 1098, 1123, 906, 1157, 938, 919, 917, 668, 1358, 1145, 1053, 967, 967, 1238, 1234, 995, 1175, 1216],
            [169, 300, 1122, 1677, 1108, 2357, 2519, 1644, 1764, 1944, 1250, 1572, 1538, 1068, 1134, 1034, 1181, 903, 1096, 1257, 839, 783, 885, 811, 746],
            [104, 288, 733, 666, 701, 1316, 1580, 874, 748, 1014, 966, 1111, 1063, 1137, 1399, 1147, 1711, 1671, 1394, 1151, 1508, 1310, 1225, 1382, 1431],
            [156, 327, 925, 998, 921, 1318, 1598, 1202, 1071, 1386, 1104, 882, 1312, 1211, 1173, 1706, 1386, 1403, 1845, 1551, 2243, 2084, 2115, 1978, 1865],
            [168, 351, 724, 1076, 851, 1734, 1519, 796, 614, 692, 731, 415, 462, 478, 324, 432, 368, 355, 403, 463, 427, 868, 403, 547, 632],
            [194, 269, 1271, 1449, 1195, 2833, 2506, 1215, 1301, 1488, 1236, 1060, 1369, 1030, 1205, 1342, 1224, 1206, 1570, 1743, 1375, 1214, 1824, 1532, 1365],
            [126, 205, 507, 825, 930, 1345, 1648, 852, 1031, 1095, 1029, 972, 1218, 1119, 920, 1281, 1126, 1080, 815, 774, 832, 718, 722, 697, 645],
            [44, 75, 357, 764, 755, 971, 1285, 496, 999, 642, 832, 558, 703, 319, 552, 587, 567, 420, 577, 584, 490, 605, 591, 443, 386],
            [155, 171, 381, 678, 619, 832, 724, 512, 389, 266, 320, 300, 311, 229, 287, 478, 305, 214, 328, 357, 254, 286, 395, 565, 638],
            [127, 35, 238, 570, 188, 445, 736, 667, 543, 337, 407, 400, 668, 647, 463, 620, 582, 284, 804, 906, 624, 460, 388, 443, 553],
            [195, 151, 650, 945, 865, 1380, 1377, 977, 1070, 920, 1058, 1157, 1067, 581, 1007, 1067, 696, 809, 572, 619, 517, 792, 648, 890, 938],
            [319, 255, 853, 1425, 1057, 1870, 2029, 1614, 1464, 1553, 1635, 1476, 1779, 1835, 1746, 2116, 1261, 1215, 1081, 1132, 970, 715, 621, 866, 961],
            [247, 224, 664, 943, 780, 1494, 1279, 1279, 917, 813, 952, 939, 1028, 762, 1186, 1043, 779, 1012, 856, 684, 837, 758, 721, 1126, 1264],
            [89, 38, 242, 415, 384, 678, 655, 622, 754, 551, 608, 317, 449, 228, 395, 342, 321, 349, 158, 110, 243, 322, 212, 204, 176],
            [227, 225, 679, 920, 720, 1210, 1118, 859, 872, 722, 1027, 561, 633, 581, 627, 654, 563, 746, 554, 576, 657, 1058, 593, 758, 836],
            [218, 196, 689, 799, 709, 1069, 1130, 667, 683, 560, 735, 846, 719, 599, 668, 1140, 682, 829, 684, 1065, 785, 686, 741, 865, 973],
            [161, 215, 542, 777, 852, 1560, 1461, 786, 667, 441, 551, 533, 441, 367, 451, 642, 415, 484, 340, 481, 416, 493, 328, 294, 235]
        ];

        // 将数据转换为热力图格式 [xIndex, yIndex, value]
        const data = [];
        for (let i = 0; i < categories.length; i++) {
            for (let j = 0; j < years.length; j++) {
                data.push([j, i, dataMatrix[i][j] || 0]);
            }
        }

        // 初始化图表
        const chartDom = document.getElementById('chart-container');
        const myChart = echarts.init(chartDom);
        
        // 颜色方案
        const colorSchemes = [
            ['#fee5d9', '#fcae91', '#fb6a4a', '#de2d26', '#a50f15'], // 红色系
            ['#e0f3db', '#abdda4', '#66c2a4', '#3288bd', '#5e4fa2'], // 蓝绿色系
            ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'] // 黄色到红色
        ];
        
        let currentColorScheme = 0;
        let showLabels = true;

        // 计算数据范围
        const minValue = 0;
        const maxValue = Math.max(...dataMatrix.flat());
        
        // 配置项
        const option = {
            tooltip: {
                position: 'top',
                formatter: function (params) {
                    return `<strong>${categories[params.data[1]]}</strong><br/>
                            ${years[params.data[0]]}: <span style="color: #e74c3c; font-weight: bold;">${params.data[2]}</span>`;
                },
                backgroundColor: 'rgba(255, 255, 255, 0.9)',
                borderColor: '#3498db',
                textStyle: {
                    color: '#2c3e50'
                }
            },
            grid: {
                height: '75%',
                top: '10%',
                left: '10%',
                right: '5%'
            },
            xAxis: {
                type: 'category',
                data: years,
                splitArea: {
                    show: true
                },
                axisLabel: {
                    interval: 0,
                    rotate: 45,
                    margin: 15
                }
            },
            yAxis: {
                type: 'category',
                data: categories,
                splitArea: {
                    show: true
                },
                axisLabel: {
                    margin: 15
                },
                inverse: true // 关键设置：反转Y轴，使Visual在顶部，Painting在底部
            },
            visualMap: {
                min: minValue,
                max: maxValue,
                calculable: true,
                orient: 'horizontal',
                left: 'center',
                bottom: '0%',
                text: ['高', '低'],
                textStyle: {
                    color: '#2c3e50'
                },
                inRange: {
                    color: colorSchemes[currentColorScheme]
                }
            },
            series: [
                {
                    name: '数据值',
                    type: 'heatmap',
                    data: data,
                    label: {
                        show: showLabels,
                        color: '#2c3e50',
                        fontWeight: 'bold',
                        fontSize: 11,
                        formatter: function(params) {
                            // 对于较小的值，使用更深的颜色提高可读性
                            return params.data[2] > 0 ? params.data[2] : '';
                        }
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    },
                    itemStyle: {
                        borderColor: '#fff',
                        borderWidth: 1
                    }
                }
            ]
        };

        // 使用配置项和数据显示图表
        myChart.setOption(option);
        
        // 切换标签显示
        document.getElementById('toggle-labels').addEventListener('click', function() {
            showLabels = !showLabels;
            option.series[0].label.show = showLabels;
            myChart.setOption(option);
        });
        
        // 切换颜色方案
        document.getElementById('change-color').addEventListener('click', function() {
            currentColorScheme = (currentColorScheme + 1) % colorSchemes.length;
            option.visualMap.inRange.color = colorSchemes[currentColorScheme];
            myChart.setOption(option);
        });
        
        // 重置视图
        document.getElementById('reset-view').addEventListener('click', function() {
            myChart.dispatchAction({
                type: 'dataZoom',
                start: 0,
                end: 100
            });
        });
        
        // 响应窗口大小变化
        window.addEventListener('resize', function() {
            myChart.resize();
        });
    </script>
</body>
</html>